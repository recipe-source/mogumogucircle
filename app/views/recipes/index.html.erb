<h1>おすすめれしぴ診断スタート</h1>
<%= link_to "診断を始める", new_perfume_path, class: "link" %>
<h3>Recipe一覧</h3>

<h3>投稿を検索</h3>
 <%= form_tag({controller:"recipes",action:"index"}, method: :get) do %>
   <%= text_field_tag :search %>
   <%= submit_tag '検索する'  %>
<% end %>

<%= link_to "新規投稿へ", new_recipe_path %>

<% @recipes.each do |t| %>

   <div class="like-section">
      <% if user_signed_in? %>

        <% if current_user.already_liked?(t) %>
           <%= link_to recipe_like_path(id: t.id, recipe_id: t.id), data: { turbo_method: :delete } do %>
               <p>いいねを取り消す</p><%= t.likes.count %>
           <% end %>

        <% else %>

           <%= link_to recipe_likes_path(id: t.id, recipe_id: t.id), data: { turbo_method: :post }  do %>
               <p>いいね</p><%= t.likes.count %>
           <% end %>
        <% end %>

      <% else %>
        <p>いいねの数 = </p><%= t.likes.count %>
      <% end %>

        <% if t.image.attached? %>
            <%= image_tag t.image, size: '250x200'%>
        <% end %>
    
        <%= t.name %>
        <%= t.material %>
        <%= t.process %>
        <%= t.cost %>
        <%= t.time %>
        <%= t.created_at %>

        <%= link_to "詳細へ", recipe_path(t.id) %>
        <%= link_to "編集する", edit_recipe_path(t.id) %>
        <%= link_to "削除する", recipe_path(t.id), method: :delete %>
       </div>
    <%= t.user.email %>

<% end %>